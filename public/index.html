<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <!-- <meta name="referrer" content="no-referrer"/> -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/5220/5220478.png">
    <meta name="author" content="Rupesh Shah">
    <meta name="description" content="A powerful and efficient URL resolution web app service that tracks campaign parameters, handles complex redirects, and validates marketing URLs.">
    <meta name="google-site-verification" content="asegsNffwXTljUqyu173MU6zcZ0-uSf9heJOXc3K7Jc" />
    <link
      href="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/css/select2.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./components/page-loader/loader.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Include Select2 JS -->
    <script src="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/js/select2.min.js"></script>
    <!-- Flatpickr CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"
    />
    <!-- Flatpickr JS -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <!-- Link Stylesheet -->
    <link rel="stylesheet" href="./style.css">
    <link rel="preload" href="./style.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <!-- Support xlsx -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    <title>URL TraceToEnd</title>
    <script>
      fetch('/api/auth/me').then(r=>r.json()).then(d=>{ if(!d.user){ location.href='/login'; }});
    </script>
  </head>
  <body>
    <div id="navbar-root"></div>
    <div class="container">
      <div class="header">
        <h1>ğŸ”— Affiliate URL Resolver</h1>
        <p class="subtitle">
          Track and manage your affiliate campaign URLs with ease
        </p>
      </div>

      <div class="form-section">
        <div class="form-grid">
          <div class="form-group">
            <label id="campaign-link" for="campaign-url"
              >Campaign URL <span style="color: red">*</span></label
            >
            <input
              required
              id="campaign-url"
              placeholder="e.g. Campaign URL (https://brand.domain.com/sub-page)"
            />
          </div>
          <div class="form-group">
            <label for="campaign-tags"
              >Tags/Notes/Campaign Name <span style="color: red">*</span></label
            >
            <input
              required
              id="campaign-tags"
              placeholder="e.g. chat, ai, marketing, manychat campaign"
            />
          </div>
          <div class="form-group">
            <label for="url-country"
              >Country <span id="country-status" class="status-indicator"></span
            ></label>
            <select id="url-country">
              <option value="">Detecting location...</option>
              <option value="IN">ğŸ‡®ğŸ‡³ India (IN)</option>
              <option value="US">ğŸ‡ºğŸ‡¸ United States (US)</option>
              <option value="CA">ğŸ‡¨ğŸ‡¦ Canada (CA)</option>
              <option value="AU">ğŸ‡¦ğŸ‡º Australia (AU)</option>
              <option value="GB">ğŸ‡¬ğŸ‡§ United Kingdom (GB)</option>
              <option value="NZ">ğŸ‡³ğŸ‡¿ New Zealand (NZ)</option>
              <option value="SG">ğŸ‡¸ğŸ‡¬ Singapore (SG)</option>
              <option value="HK">ğŸ‡­ğŸ‡° Hong Kong (HK)</option>
              <option value="MY">ğŸ‡²ğŸ‡¾ Malaysia (MY)</option>
              <option value="PH">ğŸ‡µğŸ‡­ Philippines (PH)</option>
              <option value="ID">ğŸ‡®ğŸ‡© Indonesia (ID)</option>
              <option value="TH">ğŸ‡¹ğŸ‡­ Thailand (TH)</option>
              <option value="VN">ğŸ‡»ğŸ‡³ Vietnam (VN)</option>
              <option value="BR">ğŸ‡§ğŸ‡· Brazil (BR)</option>
              <option value="AR">ğŸ‡¦ğŸ‡· Argentina (AR)</option>
              <option value="CO">ğŸ‡¨ğŸ‡´ Colombia (CO)</option>
              <option value="MX">ğŸ‡²ğŸ‡½ Mexico (MX)</option>
              <option value="PE">ğŸ‡µğŸ‡ª Peru (PE)</option>
              <option value="CL">ğŸ‡¨ğŸ‡± Chile (CL)</option>
              <option value="EC">ğŸ‡ªğŸ‡¨ Ecuador (EC)</option>
              <option value="BO">ğŸ‡§ğŸ‡´ Bolivia (BO)</option>
              <option value="UY">ğŸ‡ºğŸ‡¾ Uruguay (UY)</option>
              <option value="PY">ğŸ‡µğŸ‡¾ Paraguay (PY)</option>
              <option value="UZ">ğŸ‡ºğŸ‡¿ Uzbekistan (UZ)</option>
              <option value="KZ">ğŸ‡°ğŸ‡¿ Kazakhstan (KZ)</option>
              <option value="KG">ğŸ‡°ğŸ‡¬ Kyrgyzstan (KG)</option>
              <option value="AZ">ğŸ‡¦ğŸ‡¿ Azerbaijan (AZ)</option>
              <option value="GE">ğŸ‡¬ğŸ‡ª Georgia (GE)</option>
              <option value="AM">ğŸ‡¦ğŸ‡² Armenia (AM)</option>
              <option value="TM">ğŸ‡¹ğŸ‡² Turkmenistan (TM)</option>
              <option value="DE">ğŸ‡©ğŸ‡ª Germany (DE)</option>
              <option value="FR">ğŸ‡«ğŸ‡· France (FR)</option>
              <option value="IT">ğŸ‡®ğŸ‡¹ Italy (IT)</option>
              <option value="ES">ğŸ‡ªğŸ‡¸ Spain (ES)</option>
              <option value="NL">ğŸ‡³ğŸ‡± Netherlands (NL)</option>
              <option value="JP">ğŸ‡¯ğŸ‡µ Japan (JP)</option>
              <option value="KR">ğŸ‡°ğŸ‡· South Korea (KR)</option>
              <option value="RU">ğŸ‡·ğŸ‡º Russia (RU)</option>
              <option value="CN">ğŸ‡¨ğŸ‡³ China (CN)</option>
              <option value="TR">ğŸ‡¹ğŸ‡· Turkey (TR)</option>
              <option value="SA">ğŸ‡¸ğŸ‡¦ Saudi Arabia (SA)</option>
              <option value="AE">ğŸ‡¦ğŸ‡ª UAE (AE)</option>
              <option value="EG">ğŸ‡ªğŸ‡¬ Egypt (EG)</option>
              <option value="ZA">ğŸ‡¿ğŸ‡¦ South Africa (ZA)</option>
              <option value="CZ">ğŸ‡¨ğŸ‡¿ Czechia (CZ)</option>
              <option value="UA">ğŸ‡ºğŸ‡¦ Ukraine (UA)</option>
              <option value="PL">ğŸ‡µğŸ‡± Poland (PL)</option>
              <option value="AL">ğŸ‡¦ğŸ‡± Albania (AL)</option>
              <option value="DZ">ğŸ‡©ğŸ‡¿ Algeria (DZ)</option>
              <option value="AD">ğŸ‡¦ğŸ‡© Andorra (AD)</option>
              <option value="AT">ğŸ‡¦ğŸ‡¹ Austria (AT)</option>
              <option value="BS">ğŸ‡§ğŸ‡¸ Bahamas (BS)</option>
              <option value="BD">ğŸ‡§ğŸ‡© Bangladesh (BD)</option>
              <option value="BE">ğŸ‡§ğŸ‡ª Belgium (BE)</option>
              <option value="BZ">ğŸ‡§ğŸ‡¿ Belize (BZ)</option>
              <option value="BT">ğŸ‡§ğŸ‡¹ Bhutan (BT)</option>
              <option value="NG">ğŸ‡³ğŸ‡¬ Nigeria (NG)</option>
              <option value="BG">ğŸ‡§ğŸ‡¬ Bulgaria (BG)</option>
              <option value="HU">ğŸ‡­ğŸ‡º Hungary (HU)</option>
              <option value="TW">ğŸ‡¹ğŸ‡¼ Taiwan (TW)</option>
              <option value="HR">ğŸ‡­ğŸ‡· Croatia (HR)</option>
              <option value="BY">ğŸ‡§ğŸ‡¾ Belarus (BY)</option>
              <option value="DK">ğŸ‡©ğŸ‡° Denmark (DK)</option>
              <option value="GR">ğŸ‡¬ğŸ‡· Greece (GR)</option>
              <option value="NO">ğŸ‡³ğŸ‡´ Norway (NO)</option>
              <option value="IS">ğŸ‡®ğŸ‡¸ Iceland (IS)</option>
              <option value="SE">ğŸ‡¸ğŸ‡ª Sweden (SE)</option>
              <option value="PT">ğŸ‡µğŸ‡¹ Portugal (PT)</option>
              <option value="CH">ğŸ‡¨ğŸ‡­ Switzerland (CH)</option>
              <option value="IL">ğŸ‡®ğŸ‡± Israel (IL)</option>
              <option value="MD">ğŸ‡²ğŸ‡© Moldova (MD)</option>
              <option value="RO">ğŸ‡·ğŸ‡´ Romania (RO)</option>
              <option value="IE">ğŸ‡®ğŸ‡ª Ireland (IE)</option>
              <option value="FL">ğŸ‡±ğŸ‡® Liechtenstein (FL)</option>
              <option value="FI">ğŸ‡«ğŸ‡® Finland (FI)</option>
            </select>
          </div>
          <div class="form-group">
            <label for="ua-type">User-Agent Type <span style="color: red">*</span></label>
            <select id="ua-type" required>
              <option value="" disabled>Select User-Agent Type</option>
              <option value="random" selected>ğŸ”„ Rotating UA</option>
              <option value="desktop">ğŸ–¥ï¸ Desktop</option>
              <option value="mobile">ğŸ“± Mobile</option>
            </select>
          </div>
        </div>

        <div class="action-buttons">
          <button class="btn-primary" onclick="addCampaign()">
            âœ¨ Add Campaign
          </button>
          <button class="btn-secondary" onclick="exportCSV()">
            ğŸ“Š Export CSV
          </button>
          <button class="refresh-location" onclick="detectLocation()">
            ğŸŒ Refresh Location
          </button>
          <select
            class="custom-select"
            id="sortDate"
            onchange="sortTableByDate()"
          >
            <option value="newest">ğŸ“… Sort by Newest</option>
            <option value="oldest">ğŸ“… Sort by Oldest</option>
            <option value="import">ğŸ“¥ Sort by Import Order</option>
          </select>
          <div class="filter-group">
            <input
              type="text"
              id="dateRange"
              placeholder="ğŸ“† Filter by Date Range"
            />
            <button
              onclick="clearDateFilter()"
              class="clear-date-btn"
            >
              âŒ Clear Date Filter
            </button>
          </div>
        </div>
        <div class="form-group file-import">
          <label for="fileImport"
            >Import File (Just drop the file rest leave it to me)</label
          >
          <input
            type="file"
            id="fileImport"
            accept=".csv, .xlsx"
            onchange="handleFileImport(event)"
          />
        </div>
      </div>

      <div class="table-section">
        <div class="table-controls">
          <input
            class="search-bar"
            id="searchInput"
            onkeyup="filterTable()"
            placeholder="ğŸ” Search campaigns, URLs, tags..."
          />
          <!-- <button
            class="refresh-urls-btn"
            id="refreshAllBtn"
            onclick="refreshAllUrls()"
          >
            ğŸ”„ Refresh All URLs
          </button> -->
          <button
            class="btn-warning"
            id="deleteAllEntries"
            onclick="deleteTableRows()"
          >
            ğŸ—‘ï¸ Delete All Entries
          </button>
        </div>

        <table id="campaignTable">
          <thead>
            <tr>
              <th>ğŸ“… Date Added</th>
              <th>ğŸ”— Campaign URL</th>
              <th>ğŸ¯ Final URL</th>
              <th>ğŸŒ Country</th>
              <th>ğŸ·ï¸ Tags/Notes/Campaign Name</th>
              <th>ğŸ–¥ï¸ / ğŸ“± UA</th>
              <th>âš¡ Actions</th>
            </tr>
          </thead>
          <tbody id="tableBody"></tbody>

          <tfoot>
            <tr id="loadingRow" style="display: none">
              <td colspan="7" style="text-align: center; font-style: italic">
                <!-- Loading... -->
                <div class="loader">
                  <span class="loader-text">loading...</span>
                  <span class="load"></span>
                </div>
              </td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
    <div class="floating-navbar">
      <div class="button-container">
        <a href="./resolution-stats/resolutions.html" class="button" title="Link">
          <svg class="icon" viewBox="0 0 1024 1024" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path d="M574.6 266.7c-22.2 0-40.2 18-40.2 40.2s18 40.2 40.2 40.2h163.6c38.6 0 70.1 31.5 70.1 70.1s-31.5 70.1-70.1 70.1H555.4c-61.3 0-111.1 49.8-111.1 111.1s49.8 111.1 111.1 111.1h163.6c22.2 0 40.2-18 40.2-40.2s-18-40.2-40.2-40.2H574.6c-18.3 0-33.1-14.8-33.1-33.1s14.8-33.1 33.1-33.1h182.8c76.5 0 138.7-62.2 138.7-138.7s-62.2-138.7-138.7-138.7H574.6zM449.4 757.3c22.2 0 40.2-18 40.2-40.2s-18-40.2-40.2-40.2H285.8c-38.6 0-70.1-31.5-70.1-70.1s31.5-70.1 70.1-70.1h182.8c61.3 0 111.1-49.8 111.1-111.1S530 314.6 468.7 314.6H305.1c-22.2 0-40.2 18-40.2 40.2s18 40.2 40.2 40.2h163.6c18.3 0 33.1 14.8 33.1 33.1s-14.8 33.1-33.1 33.1H285.8c-76.5 0-138.7 62.2-138.7 138.7s62.2 138.7 138.7 138.7h163.6z"/>
          </svg>
          <span class="label">Resolution Stats</span>
        </a>
        <a href="../analytics/stats.html" class="button" title="Analytics">
          <svg class="icon" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path d="M4 22h16v-2H4v2zm2-4h2v-7H6v7zm5 0h2V6h-2v12zm5 0h2v-4h-2v4z"/>
          </svg>
          <span class="label">Analytics</span>
        </a>
        <a href="../time-stats/time-stats.html" class="button" title="Time Stats">
          <svg class="icon" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 1.75C6.07 1.75 1.25 6.57 1.25 12.5S6.07 23.25 12 23.25 22.75 18.43 22.75 12.5 17.93 1.75 12 1.75zm0 20c-5.1 0-9.25-4.15-9.25-9.25S6.9 3.25 12 3.25 21.25 7.4 21.25 12.5 17.1 21.75 12 21.75zm.75-14h-1.5v6l5.25 3.15.75-1.23-4.5-2.67V7.75z"/>
          </svg>
          <span class="label">Time Stats</span>
        </a>
        <a href="/dashboard.html" class="button" title="Activity Dashboard">
          <svg class="icon" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"/>
          </svg>
          <span class="label">Activity</span>
        </a>
      </div>
    </div>
    <!-- Custom Modal -->
    <div id="confirmModal">
      <div class="card">
        <div class="card-content">
          <p class="card-heading">Delete all entries?</p>
          <p class="card-description">Are you sure you want to delete all entries? This action cannot be undone.</p>
        </div>
        <div class="card-button-wrapper">
          <button class="card-button secondary" id="cancelBtn">Cancel</button>
          <button class="card-button primary" id="deleteBtn">Delete</button>
        </div>
        <button class="exit-button" id="exitBtn">
          <svg height="20px" viewBox="0 0 384 512">
            <path d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"/>
          </svg>
        </button>
      </div>
    </div>
    <!-- Network Status Toast -->
    <div id="network-toast" class="network-toast hidden"></div>
    <script src="./components/page-loader/loader.js" defer></script>
    <script src="./components/navbar/navbar.js" defer></script>
    <script src="app.js"></script>
  </body>
</html>